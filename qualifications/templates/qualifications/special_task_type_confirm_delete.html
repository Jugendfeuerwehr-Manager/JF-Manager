{% extends 'qualifications/base.html' %}

{% block title %}Sonderaufgaben-Typ löschen{% endblock %}

{% block page_header %}
<h1 class="h3 mb-4">Sonderaufgaben-Typ löschen</h1>
{% endblock %}

{% block content %}
<!-- Breadcrumbs -->
<ol class="breadcrumb mb-4">
    <li class="breadcrumb-item"><a href="{% url 'qualifications:dashboard' %}">Qualifikationen & Sonderaufgaben</a></li>
    <li class="breadcrumb-item"><a href="{% url 'qualifications:admin' %}">Verwaltung</a></li>
    <li class="breadcrumb-item"><a href="{% url 'qualifications:special_task_type_list' %}">Sonderaufgaben-Typen</a></li>
    <li class="breadcrumb-item active">{{ object.name }} löschen</li>
</ol>

<div class="card">
    <div class="card-header bg-danger text-white">
        <h5 class="card-title mb-0">
            <i class="fas fa-exclamation-triangle"></i>
            Bestätigung erforderlich
        </h5>
    </div>
    <div class="card-body">
        <p class="mb-3">
            Sind Sie sicher, dass Sie den Sonderaufgaben-Typ 
            <strong>"{{ object.name }}"</strong> löschen möchten?
        </p>
        
        {% if object.description %}
        <div class="alert alert-light">
            <strong>Beschreibung:</strong> {{ object.description }}
        </div>
        {% endif %}
        
        {% if object.specialtasks.exists %}
        <div class="alert alert-warning">
            <h6><i class="fas fa-exclamation-triangle"></i> Achtung</h6>
            <p class="mb-2">
                Dieser Sonderaufgaben-Typ ist mit <strong>{{ object.specialtasks.count }}</strong> 
                Sonderaufgabe{% if object.specialtasks.count != 1 %}n{% endif %} verknüpft:
            </p>
            <ul class="mb-0">
                {% for task in object.specialtasks.all|slice:":5" %}
                <li>{{ task.get_person_name }} ({{ task.start_date }} - {{ task.end_date|default:"laufend" }})</li>
                {% endfor %}
                {% if object.specialtasks.count > 5 %}
                <li><em>... und {{ object.specialtasks.count|add:"-5" }} weitere</em></li>
                {% endif %}
            </ul>
            <p class="mt-2 mb-0">
                <strong>Alle diese Sonderaufgaben werden ebenfalls gelöscht!</strong>
            </p>
        </div>
        {% endif %}
        
        <form method="post" class="d-inline">
            {% csrf_token %}
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-danger">
                    <i class="fas fa-trash"></i>
                    Ja, löschen
                </button>
                <a href="{% url 'qualifications:special_task_type_list' %}" class="btn btn-secondary">
                    <i class="fas fa-times"></i>
                    Abbrechen
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
